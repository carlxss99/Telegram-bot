// /setlang
var lang = params; // Obtener el idioma seleccionado del comando

if (lang) { 
    // Guardar el idioma seleccionado en la propiedad del usuario 
    User.setProperty("language", lang, "string");

    // Actualizar el idioma en el objeto de datos del usuario, si existe
    let userData = Bot.getProperty("user_" + user.telegramid);
    if (userData) {
      userData.language = lang;
      Bot.setProperty("user_" + user.telegramid, userData, "json");
    }

    // Mensajes de confirmaciÃ³n en diferentes idiomas
    var messages = {
        es: {
            confirmation: "âœ… Idioma cambiado a EspaÃ±ol.",
            backToMenu: "ğŸ”™ Volver al MenÃº"
        },
        en: {
            confirmation: "âœ… Language changed to English.",
            backToMenu: "ğŸ”™ Back to Menu"
        },
        ru: {
            confirmation: "âœ… Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½ Ğ½Ğ° Ğ ÑƒÑÑĞºĞ¸Ğ¹.",
            backToMenu: "ğŸ”™ Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğ² Ğ¼ĞµĞ½Ñ"
        },
        hi: {  // Hindi
            confirmation: "âœ… à¤­à¤¾à¤·à¤¾ à¤¹à¤¿à¤‚à¤¦à¥€ à¤®à¥‡à¤‚ à¤¬à¤¦à¤² à¤—à¤ˆà¥¤",
            backToMenu: "ğŸ”™ à¤®à¥‡à¤¨à¥‚ à¤ªà¤° à¤µà¤¾à¤ªà¤¸ à¤œà¤¾à¤à¤‚"
        },
        zh: {  // Chino simplificado
            confirmation: "âœ… è¯­è¨€å·²æ›´æ”¹ä¸ºä¸­æ–‡ã€‚",
            backToMenu: "ğŸ”™ è¿”å›èœå•"
        },
        ja: {  // JaponÃ©s
            confirmation: "âœ… è¨€èªãŒæ—¥æœ¬èªã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚",
            backToMenu: "ğŸ”™ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹"
        },
        ar: {  // Ãrabe
            confirmation: "âœ… ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.",
            backToMenu: "ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©"
        }
    };

    // BotÃ³n para volver al menÃº principal
    var backButton = [[{ title: messages[lang].backToMenu, command: "/start" }]];

    // Enviar mensaje de confirmaciÃ³n con el botÃ³n
    Bot.sendInlineKeyboard(backButton, messages[lang].confirmation);
} else { 
    // Mostrar opciones de idioma si no se seleccionÃ³ ninguno
    var langOptions = [
        [{ title: "ğŸ‡ªğŸ‡¸ EspaÃ±ol", command: "/setlang es" }],
        [{ title: "ğŸ‡ºğŸ‡¸ English", command: "/setlang en" }],
        [{ title: "ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹", command: "/setlang ru" }],
        [{ title: "ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤‚à¤¦à¥€", command: "/setlang hi" }],  // OpciÃ³n en hindi
        [{ title: "ğŸ‡¨ğŸ‡³ ä¸­æ–‡", command: "/setlang zh" }],  // OpciÃ³n en chino simplificado
        [{ title: "ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª", command: "/setlang ja" }],  // OpciÃ³n en japonÃ©s
        [{ title: "ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", command: "/setlang ar" }]  // OpciÃ³n en Ã¡rabe
    ];

    Bot.sendInlineKeyboard(langOptions, "ğŸŒ Please select your preferred language:");
}
