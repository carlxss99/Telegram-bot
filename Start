// ğŸ“Œ /start - Comando principal del bot

// ğŸŒ Detectar el idioma del usuario
var userLang = User.getProperty("language");
if (!userLang) {
  userLang = request.language_code ? request.language_code.substring(0, 2).toLowerCase() : "es";
  if (["es", "en", "ru", "ja", "hi", "zh", "ar"].indexOf(userLang) === -1) {  
    userLang = "es";  
  }  
  User.setProperty("language", userLang, "string");
}

// ğŸŒ Mensajes en varios idiomas
var messages = {
  registro_exitoso: {
    es: "âœ… Registro exitoso. Â¡Ya puedes empezar a usar el bot! ğŸ‰",
    en: "âœ… Successful registration. You can now start using the bot! ğŸ‰",
    ru: "âœ… Ğ£ÑĞ¿ĞµÑˆĞ½Ğ°Ñ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ. Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ²Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ñ‚! ğŸ‰",
    ja: "âœ… ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚ãƒœãƒƒãƒˆã‚’ä½¿ã„å§‹ã‚ã¾ã—ã‚‡ã†ï¼ğŸ‰",
    hi: "âœ… à¤ªà¤‚à¤œà¥€à¤•à¤°à¤£ à¤¸à¤«à¤² à¤°à¤¹à¤¾à¥¤ à¤…à¤¬ à¤†à¤ª à¤¬à¥‰à¤Ÿ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤¶à¥à¤°à¥‚ à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚! ğŸ‰",
    zh: "âœ… æ³¨å†ŒæˆåŠŸã€‚ç°åœ¨å¯ä»¥å¼€å§‹ä½¿ç”¨æœºå™¨äººäº†ï¼ğŸ‰",
    ar: "âœ… ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¨Ø¯Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª! ğŸ‰"
  },
  nuevo_referido: {
    es: "ğŸ‰ Un nuevo usuario se ha unido con tu enlace de referido. Has ganado 50 puntos.",
    en: "ğŸ‰ A new user has joined using your referral link. You have earned 50 points.",
    ru: "ğŸ‰ ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¿Ñ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½Ğ¸Ğ»ÑÑ Ğ¿Ğ¾ Ğ²Ğ°ÑˆĞµĞ¹ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑÑÑ‹Ğ»ĞºĞµ. Ğ’Ñ‹ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ»Ğ¸ 50 Ğ¾Ñ‡ĞºĞ¾Ğ².",
    ja: "ğŸ‰ ã‚ãªãŸã®ç´¹ä»‹ãƒªãƒ³ã‚¯ã‹ã‚‰æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‚åŠ ã—ã¾ã—ãŸã€‚50ãƒã‚¤ãƒ³ãƒˆã‚’ç²å¾—ã—ã¾ã—ãŸã€‚",
    hi: "ğŸ‰ à¤à¤• à¤¨à¤¯à¤¾ à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾ à¤†à¤ªà¤•à¥‡ à¤°à¥‡à¤«à¤°à¤² à¤²à¤¿à¤‚à¤• à¤¸à¥‡ à¤œà¥à¤¡à¤¼à¤¾ à¤¹à¥ˆà¥¤ à¤†à¤ªà¤¨à¥‡ 50 à¤…à¤‚à¤• à¤…à¤°à¥à¤œà¤¿à¤¤ à¤•à¤¿à¤ à¤¹à¥ˆà¤‚à¥¤",
    zh: "ğŸ‰ ä¸€ä¸ªæ–°ç”¨æˆ·é€šè¿‡æ‚¨çš„æ¨èé“¾æ¥åŠ å…¥ã€‚æ‚¨è·å¾—äº†50ç§¯åˆ†ã€‚",
    ar: "ğŸ‰ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ø§Ù†Ø¶Ù… Ø¹Ø¨Ø± Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ. Ù„Ù‚Ø¯ ÙƒØ³Ø¨Øª 50 Ù†Ù‚Ø·Ø©."
  },
  ya_atraido: {
    es: "ğŸ”” Ya has sido atraÃ­do anteriormente.",
    en: "ğŸ”” You have already been attracted before.",
    ru: "ğŸ”” Ğ’Ñ‹ ÑƒĞ¶Ğµ Ğ±Ñ‹Ğ»Ğ¸ Ğ¿Ñ€Ğ¸Ğ²Ğ»ĞµÑ‡ĞµĞ½Ñ‹ Ñ€Ğ°Ğ½ĞµĞµ.",
    ja: "ğŸ”” ã‚ãªãŸã¯ã™ã§ã«ä»¥å‰ã«èª˜å°ã•ã‚Œã¾ã—ãŸã€‚",
    hi: "ğŸ”” à¤†à¤ªà¤•à¥‹ à¤ªà¤¹à¤²à¥‡ à¤¹à¥€ à¤†à¤•à¤°à¥à¤·à¤¿à¤¤ à¤•à¤¿à¤¯à¤¾ à¤œà¤¾ à¤šà¥à¤•à¤¾ à¤¹à¥ˆà¥¤",
    zh: "ğŸ”” ä½ ä»¥å‰å·²ç»è¢«å¸å¼•è¿‡ã€‚",
    ar: "ğŸ”” Ù„Ù‚Ø¯ ØªÙ… Ø¬Ø°Ø¨Ùƒ Ù…Ù† Ù‚Ø¨Ù„."
  },
  atraido_canal: {
    es: "ğŸ‰ Â¡Has sido atraÃ­do a travÃ©s del canal!",
    en: "ğŸ‰ You have been attracted through the channel!",
    ru: "ğŸ‰ Ğ’Ñ‹ Ğ±Ñ‹Ğ»Ğ¸ Ğ¿Ñ€Ğ¸Ğ²Ğ»ĞµÑ‡ĞµĞ½Ñ‹ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ°Ğ½Ğ°Ğ»!",
    ja: "ğŸ‰ ãƒãƒ£ãƒ³ãƒãƒ«ã‚’é€šã˜ã¦èª˜å°ã•ã‚Œã¾ã—ãŸï¼",
    hi: "ğŸ‰ à¤†à¤ªà¤•à¥‹ à¤šà¥ˆà¤¨à¤² à¤•à¥‡ à¤®à¤¾à¤§à¥à¤¯à¤® à¤¸à¥‡ à¤†à¤•à¤°à¥à¤·à¤¿à¤¤ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾ à¤¹à¥ˆ!",
    zh: "ğŸ‰ ä½ æ˜¯é€šè¿‡é¢‘é“å¸å¼•çš„ï¼",
    ar: "ğŸ‰ Ù„Ù‚Ø¯ ØªÙ… Ø¬Ø°Ø¨Ùƒ Ø¹Ø¨Ø± Ø§Ù„Ù‚Ù†Ø§Ø©!"
  }
};

// ğŸ“ Registrar al usuario si no existe
var userData = Bot.getProperty("user_" + user.telegramid);
if (!userData) {
  userData = {
    username: user.username || "Usuario_" + user.telegramid,
    points: 0,
    referrals: 0,
    links: [],
    referredBy: null
  };

  // ğŸ“¢ Verificar si el usuario fue referido
  var referrerId = request.start_param;
  if (referrerId && referrerId !== user.telegramid.toString()) {  
    var referrerData = Bot.getProperty("user_" + referrerId);  
    if (referrerData) {  
      referrerData.referrals += 1;
      referrerData.points += 50;

      // Guardar cambios en el usuario referidor
      Bot.setProperty("user_" + referrerId, referrerData, "json");

      // Notificar al referidor
      Bot.sendMessageToChatWithId(referrerId, messages.nuevo_referido[userLang]);

      // Registrar el referidor en los datos del nuevo usuario
      userData.referredBy = referrerId;
      userData.points += 50;
    }
  }

  // Guardar datos del nuevo usuario
  Bot.setProperty("user_" + user.telegramid, userData, "json");
  Bot.sendMessage(messages.registro_exitoso[userLang]);
}

// ğŸš€ FunciÃ³n de seguimiento de referidos
Libs.ReferralLib.currentUser.track({
    onAlreadyAttracted: function() {
        Bot.sendMessage(messages.ya_atraido[userLang]);
    },
    onAttracted: function() {
        Bot.sendMessage(messages.atraido_canal[userLang]);
    }
});
// ğŸ“¢ FunciÃ³n para enviar el mensaje de bienvenida
function sendWelcomeMessage() {
  var lang = User.getProperty("language") || "es";

  var messages = {  
    es: "ğŸ‘‹ Â¡Bienvenido a Referral Assistant! ğŸ‰\n\n" +  
        "ğŸ”¹ Â¿QuÃ© es Referral Assistant?\n" +  
        "ğŸ“Œ Un bot de Telegram diseÃ±ado para simplificar el intercambio de enlaces de referidos entre usuarios. " +  
        "Comparte tus enlaces, descubre los de otros y gana puntos por cada interacciÃ³n.\n\n" +  
        "ğŸ’¡ Â¿CÃ³mo funciona?\n" +  
        "1ï¸âƒ£ Registro: Ãšnete con el botÃ³n 'Registrar'.\n" +  
        "2ï¸âƒ£ Agregar Enlace: Comparte tu enlace con la comunidad.\n" +  
        "3ï¸âƒ£ Visitar Enlace: Explora y visita enlaces para ganar puntos.\n" +  
        "4ï¸âƒ£ Ranking: Consulta la clasificaciÃ³n de usuarios con mÃ¡s puntos.\n" +  
        "5ï¸âƒ£ Mis Puntos: Revisa tu saldo de puntos.\n" +  
        "6ï¸âƒ£ Referido: ObtÃ©n tu enlace Ãºnico y gana recompensas.\n\n" +  
        "âš¡ Usa los botones a continuaciÃ³n para comenzar:",  
    en: "ğŸ‘‹ Welcome to Referral Assistant! ğŸ‰\n\n" +  
        "ğŸ”¹ What is Referral Assistant?\n" +  
        "ğŸ“Œ A Telegram bot designed to simplify referral link sharing. " +  
        "Share your links, discover others', and earn points for each interaction.\n\n" +  
        "ğŸ’¡ How does it work?\n" +  
        "1ï¸âƒ£ Register: Join using the 'Register' button.\n" +  
        "2ï¸âƒ£ Add Link: Share your referral link.\n" +  
        "3ï¸âƒ£ Visit Links: Explore and visit links to earn points.\n" +  
        "4ï¸âƒ£ Ranking: Check the leaderboard of top users.\n" +  
        "5ï¸âƒ£ My Points: View your current balance.\n" +  
        "6ï¸âƒ£ Referral: Get your unique link and earn rewards.\n\n" +  
        "âš¡ Use the buttons below to get started:",
    ru: "ğŸ‘‹ Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Referral Assistant! ğŸ‰\n\n" +  
        "ğŸ”¹ Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Referral Assistant?\n" +  
        "ğŸ“Œ Ğ­Ñ‚Ğ¾ Telegram-Ğ±Ğ¾Ñ‚, Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ¸Ñ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ ÑÑÑ‹Ğ»ĞºĞ°Ğ¼Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸. " +  
        "Ğ”ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ ÑĞ²Ğ¾Ğ¸Ğ¼Ğ¸ ÑÑÑ‹Ğ»ĞºĞ°Ğ¼Ğ¸, Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ¾Ñ‡ĞºĞ¸ Ğ·Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ.\n\n" +  
        "ğŸ’¡ ĞšĞ°Ğº ÑÑ‚Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚?\n" +  
        "1ï¸âƒ£ Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ: ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½ÑĞ¹Ñ‚ĞµÑÑŒ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ½Ğ¾Ğ¿ĞºÑƒ 'Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ'.\n" +  
        "2ï¸âƒ£ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ: ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ ÑĞ²Ğ¾ĞµĞ¹ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑÑÑ‹Ğ»ĞºĞ¾Ğ¹.\n" +  
        "3ï¸âƒ£ ĞŸĞ¾ÑĞµÑ‚Ğ¸Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºĞ¸: Ğ˜Ğ·ÑƒÑ‡Ğ°Ğ¹Ñ‚Ğµ Ğ¸ Ğ¿Ğ¾ÑĞµÑ‰Ğ°Ğ¹Ñ‚Ğµ ÑÑÑ‹Ğ»ĞºĞ¸, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ñ‡ĞºĞ¸.\n" +  
        "4ï¸âƒ£ Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³: ĞĞ·Ğ½Ğ°ĞºĞ¾Ğ¼ÑŒÑ‚ĞµÑÑŒ Ñ Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³Ğ¾Ğ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹, Ğ½Ğ°Ğ±Ñ€Ğ°Ğ²ÑˆĞ¸Ñ… Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ²ÑĞµĞ³Ğ¾ Ğ¾Ñ‡ĞºĞ¾Ğ².\n" +  
        "5ï¸âƒ£ ĞœĞ¾Ğ¸ Ğ¾Ñ‡ĞºĞ¸: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ÑĞ²Ğ¾Ğ¹ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ¾Ñ‡ĞºĞ¾Ğ².\n" +  
        "6ï¸âƒ£ Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»: ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ ÑĞ²Ğ¾Ñ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½ÑƒÑ ÑÑÑ‹Ğ»ĞºÑƒ Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ±Ğ¾Ğ½ÑƒÑÑ‹.\n\n" +  
        "âš¡ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ½Ğ¸Ğ¶Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ:",
    ja: "ğŸ‘‹ Referral Assistantã¸ã‚ˆã†ã“ãï¼ğŸ‰\n\n" +  
        "ğŸ”¹ Referral Assistantã¨ã¯ï¼Ÿ\n" +  
        "ğŸ“Œ ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã§ã®ç´¹ä»‹ãƒªãƒ³ã‚¯ã®å…±æœ‰ã‚’ç°¡ç´ åŒ–ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸTelegramãƒœãƒƒãƒˆã§ã™ã€‚ " +  
        "ã”è‡ªèº«ã®ãƒªãƒ³ã‚¯ã‚’å…±æœ‰ã—ã€ä»–ã®ãƒªãƒ³ã‚¯ã‚’è¦‹ã¤ã‘ã€å„ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã§ãƒã‚¤ãƒ³ãƒˆã‚’ç²å¾—ã—ã¾ã—ã‚‡ã†ã€‚\n\n" +  
        "ğŸ’¡ ä½¿ã„æ–¹ã¯ï¼Ÿ\n" +  
        "1ï¸âƒ£ ç™»éŒ²: ã€Œç™»éŒ²ã€ãƒœã‚¿ãƒ³ã‚’ä½¿ã£ã¦å‚åŠ ã—ã¦ãã ã•ã„ã€‚\n" +  
        "2ï¸âƒ£ ãƒªãƒ³ã‚¯è¿½åŠ : ã”è‡ªèº«ã®ç´¹ä»‹ãƒªãƒ³ã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚\n" +  
        "3ï¸âƒ£ ãƒªãƒ³ã‚¯è¨ªå•: ãƒªãƒ³ã‚¯ã‚’è¨ªã‚Œã¦ãƒã‚¤ãƒ³ãƒˆã‚’ç²å¾—ã—ã¦ãã ã•ã„ã€‚\n" +  
        "4ï¸âƒ£ ãƒ©ãƒ³ã‚­ãƒ³ã‚°: æœ€ã‚‚å¤šãã®ãƒã‚¤ãƒ³ãƒˆã‚’ç²å¾—ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\n" +  
        "5ï¸âƒ£ ç§ã®ãƒã‚¤ãƒ³ãƒˆ: ç¾åœ¨ã®ãƒã‚¤ãƒ³ãƒˆæ®‹é«˜ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\n" +  
        "6ï¸âƒ£ ç´¹ä»‹: è‡ªåˆ†ã ã‘ã®ãƒªãƒ³ã‚¯ã‚’å–å¾—ã—ã¦å ±é…¬ã‚’å¾—ã¾ã—ã‚‡ã†ã€‚\n\n" +  
        "âš¡ ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ä½¿ã£ã¦å§‹ã‚ã¾ã—ã‚‡ã†:",
    hi: "ğŸ‘‹ Referral Assistant à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ! ğŸ‰\n\n" +  
        "ğŸ”¹ Referral Assistant à¤•à¥à¤¯à¤¾ à¤¹à¥ˆ?\n" +  
        "ğŸ“Œ à¤¯à¤¹ à¤à¤• Telegram à¤¬à¥‹à¤Ÿ à¤¹à¥ˆ à¤œà¤¿à¤¸à¥‡ à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾à¤“à¤‚ à¤•à¥‡ à¤¬à¥€à¤š à¤°à¥‡à¤«à¤°à¤² à¤²à¤¿à¤‚à¤• à¤¸à¤¾à¤à¤¾ à¤•à¤°à¤¨à¤¾ à¤¸à¤°à¤² à¤¬à¤¨à¤¾à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¡à¤¿à¤œà¤¼à¤¾à¤‡à¤¨ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤ " +  
        "à¤…à¤ªà¤¨à¥‡ à¤²à¤¿à¤‚à¤• à¤¸à¤¾à¤à¤¾ à¤•à¤°à¥‡à¤‚, à¤¦à¥‚à¤¸à¤°à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤‚à¤• à¤–à¥‹à¤œà¥‡à¤‚ à¤”à¤° à¤ªà¥à¤°à¤¤à¥à¤¯à¥‡à¤• à¤‡à¤‚à¤Ÿà¤°à¥ˆà¤•à¥à¤¶à¤¨ à¤•à¥‡ à¤²à¤¿à¤ à¤…à¤‚à¤• à¤•à¤®à¤¾à¤à¤‚à¥¤\n\n" +  
        "ğŸ’¡ à¤¯à¤¹ à¤•à¥ˆà¤¸à¥‡ à¤•à¤¾à¤® à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ?\n" +  
        "1ï¸âƒ£ à¤ªà¤‚à¤œà¥€à¤•à¤°à¤£: 'à¤ªà¤‚à¤œà¥€à¤•à¤°à¤£' à¤¬à¤Ÿà¤¨ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¤•à¥‡ à¤œà¥à¤¡à¤¼à¥‡à¤‚à¥¤\n" +  
        "2ï¸âƒ£ à¤²à¤¿à¤‚à¤• à¤œà¥‹à¤¡à¤¼à¥‡à¤‚: à¤…à¤ªà¤¨à¤¾ à¤°à¥‡à¤«à¤°à¤² à¤²à¤¿à¤‚à¤• à¤¸à¤¾à¤à¤¾ à¤•à¤°à¥‡à¤‚à¥¤\n" +  
        "3ï¸âƒ£ à¤²à¤¿à¤‚à¤• à¤¦à¥‡à¤–à¥‡à¤‚: à¤²à¤¿à¤‚à¤• à¤ªà¤° à¤œà¤¾à¤à¤‚ à¤”à¤° à¤…à¤‚à¤• à¤•à¤®à¤¾à¤à¤‚à¥¤\n" +  
        "4ï¸âƒ£ à¤°à¥ˆà¤‚à¤•à¤¿à¤‚à¤—: à¤¶à¥€à¤°à¥à¤· à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾à¤“à¤‚ à¤•à¥€ à¤¸à¥‚à¤šà¥€ à¤¦à¥‡à¤–à¥‡à¤‚à¥¤\n" +  
        "5ï¸âƒ£ à¤®à¥‡à¤°à¥‡ à¤…à¤‚à¤•: à¤…à¤ªà¤¨à¥‡ à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤…à¤‚à¤• à¤¦à¥‡à¤–à¥‡à¤‚à¥¤\n" +  
        "6ï¸âƒ£ à¤°à¥‡à¤«à¤°à¤²: à¤…à¤ªà¤¨à¤¾ à¤µà¤¿à¤¶à¥‡à¤· à¤²à¤¿à¤‚à¤• à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚ à¤”à¤° à¤ªà¥à¤°à¤¸à¥à¤•à¤¾à¤° à¤œà¥€à¤¤à¥‡à¤‚à¥¤\n\n" +  
        "âš¡ à¤¨à¥€à¤šà¥‡ à¤¦à¤¿à¤ à¤—à¤ à¤¬à¤Ÿà¤¨ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¤•à¥‡ à¤¶à¥à¤°à¥à¤†à¤¤ à¤•à¤°à¥‡à¤‚:",
    zh: "ğŸ‘‹ æ¬¢è¿ä½¿ç”¨ Referral Assistantï¼ğŸ‰\n\n" +  
        "ğŸ”¹ ä»€ä¹ˆæ˜¯ Referral Assistantï¼Ÿ\n" +  
        "ğŸ“Œ è¿™æ˜¯ä¸€ä¸ª Telegram æœºå™¨äººï¼Œæ—¨åœ¨ç®€åŒ–ç”¨æˆ·ä¹‹é—´çš„æ¨èé“¾æ¥åˆ†äº«ã€‚\n\n" +  
        "ğŸ’¡ å¦‚ä½•ä½¿ç”¨ï¼Ÿ\n" +  
        "1ï¸âƒ£ æ³¨å†Œï¼šç‚¹å‡»â€œæ³¨å†Œâ€æŒ‰é’®åŠ å…¥ã€‚\n" +  
        "2ï¸âƒ£ æ·»åŠ é“¾æ¥ï¼šä¸ç¤¾åŒºåˆ†äº«ä½ çš„é“¾æ¥ã€‚\n" +  
        "3ï¸âƒ£ è®¿é—®é“¾æ¥ï¼šæµè§ˆå¹¶è®¿é—®é“¾æ¥ä»¥èµšå–ç§¯åˆ†ã€‚\n" +  
        "4ï¸âƒ£ æ’è¡Œæ¦œï¼šæŸ¥çœ‹ç§¯åˆ†æœ€é«˜çš„ç”¨æˆ·æ’åã€‚\n" +  
        "5ï¸âƒ£ æˆ‘çš„ç§¯åˆ†ï¼šæŸ¥çœ‹ä½ çš„å½“å‰ç§¯åˆ†ã€‚\n" +  
        "6ï¸âƒ£ æ¨èï¼šè·å–ä½ çš„ç‹¬ç‰¹é“¾æ¥å¹¶èµšå–å¥–åŠ±ã€‚\n\n" +  
        "âš¡ è¯·ä½¿ç”¨ä¸‹é¢çš„æŒ‰é’®å¼€å§‹ï¼š",
    ar: "ğŸ‘‹ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Referral Assistant! ğŸ‰\n\n" +
        "ğŸ”¹ Ù…Ø§ Ù‡Ùˆ Referral AssistantØŸ\n" +
        "ğŸ“Œ Ø¨ÙˆØª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù…ØµÙ…Ù… Ù„ØªØ¨Ø³ÙŠØ· Ù…Ø´Ø§Ø±ÙƒØ© Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†. " +
        "Ø´Ø§Ø±Ùƒ Ø±ÙˆØ§Ø¨Ø·ÙƒØŒ ÙˆØ§ÙƒØªØ´Ù Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†ØŒ ÙˆØ§ÙƒØ³Ø¨ Ù†Ù‚Ø§Ø·Ù‹Ø§ Ù…Ø¹ ÙƒÙ„ ØªÙØ§Ø¹Ù„.\n\n" +
        "ğŸ’¡ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ\n" +
        "1ï¸âƒ£ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: Ø§Ù†Ø¶Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø²Ø± 'Ø§Ù„ØªØ³Ø¬ÙŠÙ„'.\n" +
        "2ï¸âƒ£ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·: Ø´Ø§Ø±Ùƒ Ø±Ø§Ø¨Ø·Ùƒ Ù…Ø¹ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹.\n" +
        "3ï¸âƒ£ Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ø±Ø§Ø¨Ø·: Ø§Ø³ØªØ¹Ø±Ø¶ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆÙ‚Ù… Ø¨Ø²ÙŠØ§Ø±ØªÙ‡Ø§ Ù„ÙƒØ³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·.\n" +
        "4ï¸âƒ£ Ø§Ù„ØªØ±ØªÙŠØ¨: ØªØ­Ù‚Ù‚ Ù…Ù† ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø°ÙˆÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø£Ø¹Ù„Ù‰.\n" +
        "5ï¸âƒ£ Ù†Ù‚Ø§Ø·ÙŠ: Ø±Ø§Ø¬Ø¹ Ø±ØµÙŠØ¯ Ù†Ù‚Ø§Ø·Ùƒ.\n" +
        "6ï¸âƒ£ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©: Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø·Ùƒ Ø§Ù„ÙØ±ÙŠØ¯ ÙˆØ§ÙƒØ³Ø¨ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª.\n\n" +
        "âš¡ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ù„Ø¨Ø¯Ø¡:"  
  };

  Bot.sendMessage(messages[lang]);
}

// ğŸš€ Enviar mensaje de bienvenida
sendWelcomeMessage();

// ğŸ›ï¸ FunciÃ³n de seguimiento de referidos
Libs.ReferralLib.currentUser.track({
    onTouchOwnLink: function() {
        Bot.sendMessage("ğŸ‘¤ Has tocado tu propio enlace de referido.");
    },
    onAlreadyAttracted: function() {
        Bot.sendMessage("ğŸ”” Ya has sido atraÃ­do anteriormente.");
    },
    onAttracted: function() {
        Bot.sendMessage("ğŸ‰ Â¡Has sido atraÃ­do a travÃ©s del canal!");
    },
    onAttractedByUser: function(refUser) {
        Bot.sendMessage("ğŸ‰ Has sido atraÃ­do por " + refUser.first_name + " (" + refUser.nickname + ")");
    }
});

// ğŸ›ï¸ MenÃº interactivo
var keyboards = {
  es: [
    [{ title: "ğŸŒ Change language", command: "/setlang" }],
    [{ title: "ğŸ“ Registrar", command: "/register" }],
    [{ title: "ğŸ”— Agregar Enlace", command: "/addlink" }],
    [{ title: "âŒ Eliminar Enlace", command: "/removelink" }],
    [{ title: "ğŸ‘€ Visitar Enlace", command: "/visitlink" }],
    [{ title: "ğŸ† Ver Ranking", command: "/rankings" }],
    [{ title: "ğŸ“Š Mis Puntos", command: "/checkpoints" }],
    [{ title: "ğŸ BonificaciÃ³n diaria", command: "/dailybonus" }],
    [{ title: "ğŸ‘¤ Perfil", command: "/profile" }],
    [{ title: "â“ Ayuda", command: "/help" }],
    [{ title: "ğŸ”— Referido", command: "/referido" }],
    [{ title: "ğŸ Ver Anuncios", command: "/publicidad" }]
  ],
  en: [
    [{ title: "ğŸŒ Change language", command: "/setlang" }],
    [{ title: "ğŸ“ Register", command: "/register" }],
    [{ title: "ğŸ”— Add Link", command: "/addlink" }],
    [{ title: "âŒ Remove Link", command: "/removelink" }],
    [{ title: "ğŸ‘€ Visit Link", command: "/visitlink" }],
    [{ title: "ğŸ† View Ranking", command: "/rankings" }],
    [{ title: "ğŸ“Š My Points", command: "/checkpoints" }],
    [{ title: "ğŸ Daily Bonus", command: "/dailybonus" }],
    [{ title: "ğŸ‘¤ Profile", command: "/profile" }],
    [{ title: "â“ Help", command: "/help" }],
    [{ title: "ğŸ”— Referral", command: "/referido" }],
    [{ title: "ğŸ View Ads", command: "/publicidad" }]
  ],
  ru: [
    [{ title: "ğŸŒ Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ·Ñ‹Ğº", command: "/setlang" }],
    [{ title: "ğŸ“ Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ", command: "/register" }],
    [{ title: "ğŸ”— Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ", command: "/addlink" }],
    [{ title: "âŒ Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ", command: "/removelink" }],
    [{ title: "ğŸ‘€ ĞŸĞ¾ÑĞµÑ‚Ğ¸Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ", command: "/visitlink" }],
    [{ title: "ğŸ† ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³", command: "/rankings" }],
    [{ title: "ğŸ“Š ĞœĞ¾Ğ¸ Ğ¾Ñ‡ĞºĞ¸", command: "/checkpoints" }],
    [{ title: "ğŸ Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ", command: "/dailybonus" }],
    [{ title: "ğŸ‘¤ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ", command: "/profile" }],
    [{ title: "â“ ĞŸĞ¾Ğ¼Ğ¾Ñ‰ÑŒ", command: "/help" }],
    [{ title: "ğŸ”— Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ñ‹", command: "/referido" }],
    [{ title: "ğŸ ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ", command: "/publicidad" }]
  ],
  ja: [
    [{ title: "ğŸŒ è¨€èªã‚’å¤‰æ›´", command: "/setlang" }],
    [{ title: "ğŸ“ ç™»éŒ²", command: "/register" }],
    [{ title: "ğŸ”— ãƒªãƒ³ã‚¯è¿½åŠ ", command: "/addlink" }],
    [{ title: "âŒ ãƒªãƒ³ã‚¯å‰Šé™¤", command: "/removelink" }],
    [{ title: "ğŸ‘€ ãƒªãƒ³ã‚¯è¨ªå•", command: "/visitlink" }],
    [{ title: "ğŸ† ãƒ©ãƒ³ã‚­ãƒ³ã‚°", command: "/rankings" }],
    [{ title: "ğŸ“Š ãƒã‚¤ãƒ³ãƒˆ", command: "/checkpoints" }],
    [{ title: "ğŸ æ¯æ—¥ãƒœãƒ¼ãƒŠã‚¹", command: "/dailybonus" }],
    [{ title: "ğŸ‘¤ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«", command: "/profile" }],
    [{ title: "â“ ãƒ˜ãƒ«ãƒ—", command: "/help" }],
    [{ title: "ğŸ”— ç´¹ä»‹", command: "/referido" }],
    [{ title: "ğŸ åºƒå‘Šã‚’è¦‹ã‚‹", command: "/publicidad" }]
  ],
  hi: [
    [{ title: "ğŸŒ à¤­à¤¾à¤·à¤¾ à¤¬à¤¦à¤²à¥‡à¤‚", command: "/setlang" }],
    [{ title: "ğŸ“ à¤ªà¤‚à¤œà¥€à¤•à¤°à¤£ à¤•à¤°à¥‡à¤‚", command: "/register" }],
    [{ title: "ğŸ”— à¤²à¤¿à¤‚à¤• à¤œà¥‹à¤¡à¤¼à¥‡à¤‚", command: "/addlink" }],
    [{ title: "âŒ à¤²à¤¿à¤‚à¤• à¤¹à¤Ÿà¤¾à¤à¤‚", command: "/removelink" }],
    [{ title: "ğŸ‘€ à¤²à¤¿à¤‚à¤• à¤¦à¥‡à¤–à¥‡à¤‚", command: "/visitlink" }],
    [{ title: "ğŸ† à¤°à¥ˆà¤‚à¤•à¤¿à¤‚à¤— à¤¦à¥‡à¤–à¥‡à¤‚", command: "/rankings" }],
    [{ title: "ğŸ“Š à¤®à¥‡à¤°à¥‡ à¤…à¤‚à¤•", command: "/checkpoints" }],
    [{ title: "ğŸ à¤¦à¥ˆà¤¨à¤¿à¤• à¤¬à¥‹à¤¨à¤¸", command: "/dailybonus" }],
    [{ title: "ğŸ‘¤ à¤ªà¥à¤°à¥‹à¤«à¤¼à¤¾à¤‡à¤²", command: "/profile" }],
    [{ title: "â“ à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾", command: "/help" }],
    [{ title: "ğŸ”— à¤°à¥‡à¤«à¤°à¤²", command: "/referido" }],
    [{ title: "ğŸ à¤µà¤¿à¤œà¥à¤à¤¾à¤ªà¤¨ à¤¦à¥‡à¤–à¥‡à¤‚", command: "/publicidad" }]
  ],
  zh: [
    [{ title: "ğŸŒ æ›´æ”¹è¯­è¨€", command: "/setlang" }],
    [{ title: "ğŸ“ æ³¨å†Œ", command: "/register" }],
    [{ title: "ğŸ”— æ·»åŠ é“¾æ¥", command: "/addlink" }],
    [{ title: "âŒ åˆ é™¤é“¾æ¥", command: "/removelink" }],
    [{ title: "ğŸ‘€ è®¿é—®é“¾æ¥", command: "/visitlink" }],
    [{ title: "ğŸ† æŸ¥çœ‹æ’å", command: "/rankings" }],
    [{ title: "ğŸ“Š æˆ‘çš„ç§¯åˆ†", command: "/checkpoints" }],
    [{ title: "ğŸ æ¯æ—¥å¥–åŠ±", command: "/dailybonus" }],
    [{ title: "ğŸ‘¤ ä¸ªäººèµ„æ–™", command: "/profile" }],
    [{ title: "â“ å¸®åŠ©", command: "/help" }],
    [{ title: "ğŸ”— æ¨è", command: "/referido" }],
    [{ title: "ğŸ æŸ¥çœ‹å¹¿å‘Š", command: "/publicidad" }]
  ],
  ar: [
    [{ title: "ğŸŒ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©", command: "/setlang" }],
    [{ title: "ğŸ“ Ø§Ù„ØªØ³Ø¬ÙŠÙ„", command: "/register" }],
    [{ title: "ğŸ”— Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·", command: "/addlink" }],
    [{ title: "âŒ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø§Ø¨Ø·", command: "/removelink" }],
    [{ title: "ğŸ‘€ Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ø±Ø§Ø¨Ø·", command: "/visitlink" }],
    [{ title: "ğŸ† Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ†ÙŠÙ", command: "/rankings" }],
    [{ title: "ğŸ“Š Ù†Ù‚Ø§Ø·ÙŠ", command: "/checkpoints" }],
    [{ title: "ğŸ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©", command: "/dailybonus" }],
    [{ title: "ğŸ‘¤ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ", command: "/profile" }],
    [{ title: "â“ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©", command: "/help" }],
    [{ title: "ğŸ”— Ø§Ù„Ø¥Ø­Ø§Ù„Ø©", command: "/referido" }],
    [{ title: "ğŸ Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª", command: "/publicidad" }]
  ]
};

var keyboardMessages = {
  es: "ğŸ“Œ Selecciona una opciÃ³n:",
  en: "ğŸ“Œ Select an option:",
  ru: "ğŸ“Œ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ¿Ñ†Ğ¸Ñ:",
  ja: "ğŸ“Œ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é¸ã‚“ã§ãã ã•ã„:",
  hi: "ğŸ“Œ à¤à¤• à¤µà¤¿à¤•à¤²à¥à¤ª à¤šà¥à¤¨à¥‡à¤‚:",
  zh: "ğŸ“Œ è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹:",
  ar: "ğŸ“Œ Ø§Ø®ØªØ± Ø®ÙŠØ§Ø±Ø§Ù‹:"
};

Bot.sendInlineKeyboard(keyboards[userLang], keyboardMessages[userLang]);
